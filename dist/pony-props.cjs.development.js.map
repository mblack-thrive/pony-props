{"version":3,"file":"pony-props.cjs.development.js","sources":["../src/use-pony/usePony.interface.ts","../src/use-pony/usePony.state.ts","../src/use-pony/utils/get-flex-order.ts","../src/use-pony/usePony.ts"],"sourcesContent":["export enum ActionKind {\n  Next = 'Next',\n  Previous = 'Previous',\n  Reset = 'Reset',\n}\n\nexport type State = {\n  activeSlideIndex: number;\n  slideDirection: ActionKind;\n};\n\nexport type Action = {\n  type: ActionKind;\n  payload: {\n    numItems: number;\n  };\n};\n","import { Action, ActionKind, State } from './usePony.interface';\n\nexport const initialState: State = {\n  activeSlideIndex: 0,\n  slideDirection: ActionKind.Reset,\n};\n\nexport const reducer = (prevState: State, action: Action) => {\n  const { type, payload } = action;\n\n  switch (type) {\n    case ActionKind.Reset:\n      return initialState;\n    case ActionKind.Previous:\n      const isFirstIndex = prevState.activeSlideIndex === 0;\n      return {\n        ...prevState,\n        slideDirection: ActionKind.Previous,\n        activeSlideIndex: isFirstIndex\n          ? payload?.numItems - 1\n          : prevState.activeSlideIndex - 1,\n      };\n    case ActionKind.Next:\n      const isLastIndex = prevState.activeSlideIndex === payload.numItems - 1;\n      return {\n        ...prevState,\n        slideDirection: ActionKind.Next,\n        activeSlideIndex: isLastIndex ? 0 : prevState.activeSlideIndex + 1,\n      };\n    default:\n      return prevState;\n  }\n};\n","/**\n * Gets the flex order for a slide.\n * @param index - the index of the slide\n * @param activeSlideIndex - the current/visible slide index\n * @param numItems - number of slides in carousel\n * @returns the flex order for a carousel item\n */\nexport const getOrder = ({\n  index,\n  activeSlideIndex,\n  numItems,\n}: Record<'index' | 'activeSlideIndex' | 'numItems', number>) =>\n  index - activeSlideIndex < 0\n    ? numItems - Math.abs(index - activeSlideIndex)\n    : index - activeSlideIndex;\n","import {\n  CSSProperties,\n  useReducer,\n  useState,\n  AriaAttributes,\n  useEffect,\n  useRef,\n} from 'react';\nimport { ActionKind } from './usePony.interface';\nimport { initialState, reducer } from './usePony.state';\nimport { getOrder } from './utils/get-flex-order';\n\n// TODO: readme\n\nexport const usePony = ({\n  numItems,\n  isAnnouncerVisible = false,\n  reduceMotion = false,\n  transitionDuration = 500,\n}: {\n  numItems: number;\n  isAnnouncerVisible?: boolean;\n  reduceMotion?: boolean;\n  transitionDuration?: number;\n}) => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const sectionRef = useRef<HTMLDivElement>(null);\n  const headingRef = useRef<HTMLHeadingElement>(null);\n  const carouselWrapperRef = useRef<HTMLDivElement>(null);\n  const carouselRef = useRef<HTMLUListElement>(null);\n  const carouselItemRef = useRef<HTMLLIElement>(null);\n  const buttonRef = useRef<HTMLButtonElement>(null);\n  const announcerRef = useRef<HTMLDivElement>(null);\n  const TRANSITION_DURATION_MS = reduceMotion ? 0 : transitionDuration;\n\n  const [currentSwipeDirection, setCurrentSwipeDirection] = useState<\n    ActionKind.Previous | ActionKind.Next | null\n  >(null);\n\n  useEffect(() => {\n    if (!sectionRef.current) {\n      throw new Error('please apply getSectionProps() to your <section>');\n    }\n    if (!headingRef.current) {\n      throw new Error('please apply getHeadingProps() to your <h{1,2,3}>');\n    }\n    if (!carouselWrapperRef.current) {\n      throw new Error('please apply getCarouselWrapperProps() to your <div>');\n    }\n    if (!carouselRef.current) {\n      throw new Error('please apply getCarouselProps() to your <ul>');\n    }\n    if (!carouselItemRef.current) {\n      throw new Error('please apply getCarouselItemProps() to your <li>');\n    }\n    if (!buttonRef.current) {\n      throw new Error('please apply getButtonProps() to your <button>');\n    }\n    if (!announcerRef.current) {\n      throw new Error('please apply getAnnouncerProps() to your <div>');\n    }\n  }, [\n    sectionRef,\n    headingRef,\n    carouselWrapperRef,\n    carouselRef,\n    carouselItemRef,\n    buttonRef,\n    announcerRef,\n  ]);\n\n  useEffect(() => {\n    // Listen for swipe direction changes. Apply appropriate translateX transition.\n    if (currentSwipeDirection) {\n      const transformArray = [\n        { transform: 'translateX(-100%)' },\n        { transform: 'translateX(0px)' },\n      ];\n\n      carouselRef?.current?.animate(\n        currentSwipeDirection === ActionKind.Previous\n          ? transformArray\n          : transformArray.reverse(),\n        {\n          easing: 'ease-in',\n          duration: TRANSITION_DURATION_MS,\n        }\n      );\n\n      // Automatically focus on new active carousel slide for a11y reasons.\n      setTimeout(() => {\n        document.getElementById('arousel-item-active')?.focus();\n      }, TRANSITION_DURATION_MS);\n    }\n  }, [state.activeSlideIndex, currentSwipeDirection, numItems]);\n\n  const slide = (slideDirection: ActionKind.Previous | ActionKind.Next) => {\n    setCurrentSwipeDirection(slideDirection);\n    dispatch({ type: slideDirection, payload: { numItems } });\n  };\n\n  const getSectionProps = () => ({\n    ref: sectionRef,\n    as: 'section',\n    'aria-labelledby': 'carousel-heading',\n    'aria-roledescription': 'carousel',\n  });\n\n  const getHeadingProps = () => ({\n    ref: headingRef,\n    id: 'carousel-heading',\n  });\n\n  const getCarouselWrapperProps = () => ({\n    ref: carouselWrapperRef,\n    style: { width: '100%', overflow: 'hidden' },\n  });\n\n  const getCarouselProps = () => ({\n    ref: carouselRef,\n    'aria-label': 'Slides',\n    style: {\n      display: 'flex',\n    },\n  });\n\n  const getCarouselItemProps = (index: number) => ({\n    ref: carouselItemRef,\n    id: `carousel-item-${index}${\n      index === state.activeSlideIndex ? '-active' : ''\n    }`,\n    'aria-roledescription': 'slide',\n    'aria-label': `${index} of ${numItems}`,\n    'aria-current': index === state.activeSlideIndex,\n    'aria-hidden': index !== state.activeSlideIndex,\n    style: {\n      order: getOrder({\n        index,\n        activeSlideIndex: state.activeSlideIndex,\n        numItems,\n      }),\n      display: 'flex',\n      flex: '1 0 100%',\n      flexBasis: '100%',\n      transition:\n        // Only apply this transition when the current swipe direction is next\n        // This ensures the re-ordering of items is smoother.\n        currentSwipeDirection === ActionKind.Next\n          ? `order ${\n              reduceMotion ? 0 : TRANSITION_DURATION_MS / 1000 + 0.1\n            }s ease-in`\n          : 'none',\n    },\n  });\n\n  const getButtonProps = (\n    direction: ActionKind.Previous | ActionKind.Next\n  ) => ({\n    ref: buttonRef,\n    'aria-label': direction === ActionKind.Previous ? 'Previous' : 'Next',\n    onClick: () => slide(direction),\n  });\n\n  const getAnnouncerProps = () => ({\n    ref: announcerRef,\n    'aria-live': 'polite' as AriaAttributes['aria-live'],\n    'aria-atomic': 'true' as AriaAttributes['aria-atomic'],\n    style: isAnnouncerVisible\n      ? {}\n      : ({\n          clip: 'rect(0 0 0 0)',\n          clipPath: 'inset(50%)',\n          height: '1px',\n          overflow: 'hidden',\n          position: 'absolute',\n          whiteSpace: 'nowrap',\n          width: '1px',\n        } as CSSProperties),\n  });\n\n  return {\n    // prop getters.\n    getSectionProps,\n    getHeadingProps,\n    getCarouselWrapperProps,\n    getCarouselProps,\n    getCarouselItemProps,\n    getButtonProps,\n    getAnnouncerProps,\n    // state.\n    state: {\n      ...state,\n      currentSwipeDirection,\n    },\n  };\n};\n"],"names":["ActionKind","initialState","activeSlideIndex","slideDirection","Reset","reducer","prevState","action","type","payload","Previous","isFirstIndex","numItems","Next","isLastIndex","getOrder","index","Math","abs","usePony","isAnnouncerVisible","reduceMotion","transitionDuration","useReducer","state","dispatch","sectionRef","useRef","headingRef","carouselWrapperRef","carouselRef","carouselItemRef","buttonRef","announcerRef","TRANSITION_DURATION_MS","useState","currentSwipeDirection","setCurrentSwipeDirection","useEffect","current","Error","transformArray","transform","animate","reverse","easing","duration","setTimeout","document","getElementById","focus","slide","getSectionProps","ref","as","getHeadingProps","id","getCarouselWrapperProps","style","width","overflow","getCarouselProps","display","getCarouselItemProps","order","flex","flexBasis","transition","getButtonProps","direction","onClick","getAnnouncerProps","clip","clipPath","height","position","whiteSpace"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,WAAYA;AACVA,EAAAA,kBAAA,SAAA;AACAA,EAAAA,sBAAA,aAAA;AACAA,EAAAA,mBAAA,UAAA;AACD,CAJD,EAAYA,kBAAU,KAAVA,kBAAU,KAAA,CAAtB;;ACEO,IAAMC,YAAY,GAAU;AACjCC,EAAAA,gBAAgB,EAAE,CADe;AAEjCC,EAAAA,cAAc,EAAEH,kBAAU,CAACI;AAFM,CAA5B;AAKP,AAAO,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACC,SAAD,EAAmBC,MAAnB;AACrB,MAAQC,IAAR,GAA0BD,MAA1B,CAAQC,IAAR;AAAA,MAAcC,OAAd,GAA0BF,MAA1B,CAAcE,OAAd;;AAEA,UAAQD,IAAR;AACE,SAAKR,kBAAU,CAACI,KAAhB;AACE,aAAOH,YAAP;;AACF,SAAKD,kBAAU,CAACU,QAAhB;AACE,UAAMC,YAAY,GAAGL,SAAS,CAACJ,gBAAV,KAA+B,CAApD;AACA,0BACKI,SADL;AAEEH,QAAAA,cAAc,EAAEH,kBAAU,CAACU,QAF7B;AAGER,QAAAA,gBAAgB,EAAES,YAAY,GAC1B,CAAAF,OAAO,QAAP,YAAAA,OAAO,CAAEG,QAAT,IAAoB,CADM,GAE1BN,SAAS,CAACJ,gBAAV,GAA6B;AALnC;;AAOF,SAAKF,kBAAU,CAACa,IAAhB;AACE,UAAMC,WAAW,GAAGR,SAAS,CAACJ,gBAAV,KAA+BO,OAAO,CAACG,QAAR,GAAmB,CAAtE;AACA,0BACKN,SADL;AAEEH,QAAAA,cAAc,EAAEH,kBAAU,CAACa,IAF7B;AAGEX,QAAAA,gBAAgB,EAAEY,WAAW,GAAG,CAAH,GAAOR,SAAS,CAACJ,gBAAV,GAA6B;AAHnE;;AAKF;AACE,aAAOI,SAAP;AApBJ;AAsBD,CAzBM;;ACPP;;;;;;;AAOA,AAAO,IAAMS,QAAQ,GAAG,SAAXA,QAAW;AAAA,MACtBC,KADsB,QACtBA,KADsB;AAAA,MAEtBd,gBAFsB,QAEtBA,gBAFsB;AAAA,MAGtBU,QAHsB,QAGtBA,QAHsB;AAAA,SAKtBI,KAAK,GAAGd,gBAAR,GAA2B,CAA3B,GACIU,QAAQ,GAAGK,IAAI,CAACC,GAAL,CAASF,KAAK,GAAGd,gBAAjB,CADf,GAEIc,KAAK,GAAGd,gBAPU;AAAA,CAAjB;;ICOMiB,OAAO,GAAG,SAAVA,OAAU;MACrBP,gBAAAA;mCACAQ;MAAAA,wDAAqB;+BACrBC;MAAAA,8CAAe;mCACfC;MAAAA,wDAAqB;;AAOrB,oBAA0BC,gBAAU,CAAClB,OAAD,EAAUJ,YAAV,CAApC;AAAA,MAAOuB,KAAP;AAAA,MAAcC,QAAd;;AACA,MAAMC,UAAU,GAAGC,YAAM,CAAiB,IAAjB,CAAzB;AACA,MAAMC,UAAU,GAAGD,YAAM,CAAqB,IAArB,CAAzB;AACA,MAAME,kBAAkB,GAAGF,YAAM,CAAiB,IAAjB,CAAjC;AACA,MAAMG,WAAW,GAAGH,YAAM,CAAmB,IAAnB,CAA1B;AACA,MAAMI,eAAe,GAAGJ,YAAM,CAAgB,IAAhB,CAA9B;AACA,MAAMK,SAAS,GAAGL,YAAM,CAAoB,IAApB,CAAxB;AACA,MAAMM,YAAY,GAAGN,YAAM,CAAiB,IAAjB,CAA3B;AACA,MAAMO,sBAAsB,GAAGb,YAAY,GAAG,CAAH,GAAOC,kBAAlD;;AAEA,kBAA0Da,cAAQ,CAEhE,IAFgE,CAAlE;AAAA,MAAOC,qBAAP;AAAA,MAA8BC,wBAA9B;;AAIAC,EAAAA,eAAS,CAAC;AACR,QAAI,CAACZ,UAAU,CAACa,OAAhB,EAAyB;AACvB,YAAM,IAAIC,KAAJ,CAAU,kDAAV,CAAN;AACD;;AACD,QAAI,CAACZ,UAAU,CAACW,OAAhB,EAAyB;AACvB,YAAM,IAAIC,KAAJ,CAAU,mDAAV,CAAN;AACD;;AACD,QAAI,CAACX,kBAAkB,CAACU,OAAxB,EAAiC;AAC/B,YAAM,IAAIC,KAAJ,CAAU,sDAAV,CAAN;AACD;;AACD,QAAI,CAACV,WAAW,CAACS,OAAjB,EAA0B;AACxB,YAAM,IAAIC,KAAJ,CAAU,8CAAV,CAAN;AACD;;AACD,QAAI,CAACT,eAAe,CAACQ,OAArB,EAA8B;AAC5B,YAAM,IAAIC,KAAJ,CAAU,kDAAV,CAAN;AACD;;AACD,QAAI,CAACR,SAAS,CAACO,OAAf,EAAwB;AACtB,YAAM,IAAIC,KAAJ,CAAU,gDAAV,CAAN;AACD;;AACD,QAAI,CAACP,YAAY,CAACM,OAAlB,EAA2B;AACzB,YAAM,IAAIC,KAAJ,CAAU,gDAAV,CAAN;AACD;AACF,GAtBQ,EAsBN,CACDd,UADC,EAEDE,UAFC,EAGDC,kBAHC,EAIDC,WAJC,EAKDC,eALC,EAMDC,SANC,EAODC,YAPC,CAtBM,CAAT;AAgCAK,EAAAA,eAAS,CAAC;AACR;AACA,QAAIF,qBAAJ,EAA2B;AAAA;;AACzB,UAAMK,cAAc,GAAG,CACrB;AAAEC,QAAAA,SAAS,EAAE;AAAb,OADqB,EAErB;AAAEA,QAAAA,SAAS,EAAE;AAAb,OAFqB,CAAvB;AAKAZ,MAAAA,WAAW,QAAX,oCAAAA,WAAW,CAAES,OAAb,0CAAsBI,OAAtB,CACEP,qBAAqB,KAAKpC,kBAAU,CAACU,QAArC,GACI+B,cADJ,GAEIA,cAAc,CAACG,OAAf,EAHN,EAIE;AACEC,QAAAA,MAAM,EAAE,SADV;AAEEC,QAAAA,QAAQ,EAAEZ;AAFZ,OAJF,EANyB;;AAiBzBa,MAAAA,UAAU,CAAC;;;AACT,iCAAAC,QAAQ,CAACC,cAAT,CAAwB,qBAAxB,4CAAgDC,KAAhD;AACD,OAFS,EAEPhB,sBAFO,CAAV;AAGD;AACF,GAvBQ,EAuBN,CAACV,KAAK,CAACtB,gBAAP,EAAyBkC,qBAAzB,EAAgDxB,QAAhD,CAvBM,CAAT;;AAyBA,MAAMuC,KAAK,GAAG,SAARA,KAAQ,CAAChD,cAAD;AACZkC,IAAAA,wBAAwB,CAAClC,cAAD,CAAxB;AACAsB,IAAAA,QAAQ,CAAC;AAAEjB,MAAAA,IAAI,EAAEL,cAAR;AAAwBM,MAAAA,OAAO,EAAE;AAAEG,QAAAA,QAAQ,EAARA;AAAF;AAAjC,KAAD,CAAR;AACD,GAHD;;AAKA,MAAMwC,eAAe,GAAG,SAAlBA,eAAkB;AAAA,WAAO;AAC7BC,MAAAA,GAAG,EAAE3B,UADwB;AAE7B4B,MAAAA,EAAE,EAAE,SAFyB;AAG7B,yBAAmB,kBAHU;AAI7B,8BAAwB;AAJK,KAAP;AAAA,GAAxB;;AAOA,MAAMC,eAAe,GAAG,SAAlBA,eAAkB;AAAA,WAAO;AAC7BF,MAAAA,GAAG,EAAEzB,UADwB;AAE7B4B,MAAAA,EAAE,EAAE;AAFyB,KAAP;AAAA,GAAxB;;AAKA,MAAMC,uBAAuB,GAAG,SAA1BA,uBAA0B;AAAA,WAAO;AACrCJ,MAAAA,GAAG,EAAExB,kBADgC;AAErC6B,MAAAA,KAAK,EAAE;AAAEC,QAAAA,KAAK,EAAE,MAAT;AAAiBC,QAAAA,QAAQ,EAAE;AAA3B;AAF8B,KAAP;AAAA,GAAhC;;AAKA,MAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB;AAAA,WAAO;AAC9BR,MAAAA,GAAG,EAAEvB,WADyB;AAE9B,oBAAc,QAFgB;AAG9B4B,MAAAA,KAAK,EAAE;AACLI,QAAAA,OAAO,EAAE;AADJ;AAHuB,KAAP;AAAA,GAAzB;;AAQA,MAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAC/C,KAAD;AAAA,WAAoB;AAC/CqC,MAAAA,GAAG,EAAEtB,eAD0C;AAE/CyB,MAAAA,EAAE,qBAAmBxC,KAAnB,IACAA,KAAK,KAAKQ,KAAK,CAACtB,gBAAhB,GAAmC,SAAnC,GAA+C,EAD/C,CAF6C;AAK/C,8BAAwB,OALuB;AAM/C,oBAAiBc,KAAjB,YAA6BJ,QANkB;AAO/C,sBAAgBI,KAAK,KAAKQ,KAAK,CAACtB,gBAPe;AAQ/C,qBAAec,KAAK,KAAKQ,KAAK,CAACtB,gBARgB;AAS/CwD,MAAAA,KAAK,EAAE;AACLM,QAAAA,KAAK,EAAEjD,QAAQ,CAAC;AACdC,UAAAA,KAAK,EAALA,KADc;AAEdd,UAAAA,gBAAgB,EAAEsB,KAAK,CAACtB,gBAFV;AAGdU,UAAAA,QAAQ,EAARA;AAHc,SAAD,CADV;AAMLkD,QAAAA,OAAO,EAAE,MANJ;AAOLG,QAAAA,IAAI,EAAE,UAPD;AAQLC,QAAAA,SAAS,EAAE,MARN;AASLC,QAAAA,UAAU;AAER;AACA/B,QAAAA,qBAAqB,KAAKpC,kBAAU,CAACa,IAArC,eAEMQ,YAAY,GAAG,CAAH,GAAOa,sBAAsB,GAAG,IAAzB,GAAgC,GAFzD,kBAII;AAhBD;AATwC,KAApB;AAAA,GAA7B;;AA6BA,MAAMkC,cAAc,GAAG,SAAjBA,cAAiB,CACrBC,SADqB;AAAA,WAEjB;AACJhB,MAAAA,GAAG,EAAErB,SADD;AAEJ,oBAAcqC,SAAS,KAAKrE,kBAAU,CAACU,QAAzB,GAAoC,UAApC,GAAiD,MAF3D;AAGJ4D,MAAAA,OAAO,EAAE;AAAA,eAAMnB,KAAK,CAACkB,SAAD,CAAX;AAAA;AAHL,KAFiB;AAAA,GAAvB;;AAQA,MAAME,iBAAiB,GAAG,SAApBA,iBAAoB;AAAA,WAAO;AAC/BlB,MAAAA,GAAG,EAAEpB,YAD0B;AAE/B,mBAAa,QAFkB;AAG/B,qBAAe,MAHgB;AAI/ByB,MAAAA,KAAK,EAAEtC,kBAAkB,GACrB,EADqB,GAEpB;AACCoD,QAAAA,IAAI,EAAE,eADP;AAECC,QAAAA,QAAQ,EAAE,YAFX;AAGCC,QAAAA,MAAM,EAAE,KAHT;AAICd,QAAAA,QAAQ,EAAE,QAJX;AAKCe,QAAAA,QAAQ,EAAE,UALX;AAMCC,QAAAA,UAAU,EAAE,QANb;AAOCjB,QAAAA,KAAK,EAAE;AAPR;AAN0B,KAAP;AAAA,GAA1B;;AAiBA,SAAO;AACL;AACAP,IAAAA,eAAe,EAAfA,eAFK;AAGLG,IAAAA,eAAe,EAAfA,eAHK;AAILE,IAAAA,uBAAuB,EAAvBA,uBAJK;AAKLI,IAAAA,gBAAgB,EAAhBA,gBALK;AAMLE,IAAAA,oBAAoB,EAApBA,oBANK;AAOLK,IAAAA,cAAc,EAAdA,cAPK;AAQLG,IAAAA,iBAAiB,EAAjBA,iBARK;AASL;AACA/C,IAAAA,KAAK,eACAA,KADA;AAEHY,MAAAA,qBAAqB,EAArBA;AAFG;AAVA,GAAP;AAeD,CArLM;;;;"}